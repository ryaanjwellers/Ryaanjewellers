<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ryaan Jewellers ‚Äî Gold & Diamonds</title>
<meta name="description" content="Ryaan Jewellers - Premium 18K gold & diamonds. Live UAE Gold Rates, Shop luxury collections." />
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
  :root{
    --bg-dark:#070707; --bg-light:#ffffff;
    --card-dark:#0f0f10; --card-light:#ffffff;
    --text-dark:#f7f2e9; --text-light:#0b0b0b;
    --gold:#d4af37;
    --muted: #cfcaca;
  }

  /* Basic reset */
  *{box-sizing:border-box}
  html,body{margin:0;height:100%}
  body{
    font-family:"Poppins",sans-serif;
    background:var(--bg-dark);
    color:var(--text-dark);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    transition:background .25s,color .25s;
  }

  /* Container */
  .wrap{max-width:1200px;margin:0 auto;padding:16px}

  /* Header */
  header{position:sticky;top:0;background:rgba(0,0,0,0.5);backdrop-filter:blur(6px);z-index:9999;border-bottom:1px solid rgba(212,175,55,0.06)}
  .nav{max-width:1200px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;padding:12px}
  .logo img{height:84px;display:block;object-fit:contain;transition:filter .25s}
  .menu{display:flex;gap:12px;align-items:center}
  .menu a{color:inherit;text-decoration:none;padding:6px 10px;border-radius:8px;font-weight:600}
  .menu a:hover{color:var(--gold)}

  /* Buttons */
  .btn{padding:10px 14px;border-radius:8px;border:none;cursor:pointer;font-weight:700}
  .btn-gold{background:var(--gold);color:#000}
  .btn-outline{background:transparent;border:1px solid rgba(255,255,255,0.08);color:inherit}

  /* Splash */
  #splash{
    position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:#000;z-index:100000;
    transition:opacity .6s,visibility .6s;opacity:1;visibility:visible;
  }
  #splash.hide{opacity:0;visibility:hidden;pointer-events:none}
  #splash .inner{width:440px;height:440px;border-radius:50%;display:flex;align-items:center;justify-content:center;position:relative;overflow:visible}
  #splash img{width:320px;height:auto;display:block;filter:drop-shadow(0 20px 60px rgba(212,175,55,0.2))}
  #splash .spark{position:absolute;inset:0;pointer-events:none}
  .spark span{position:absolute;width:8px;height:8px;border-radius:50%;background:radial-gradient(circle,#fff,#ffd966 40%,transparent);opacity:0;animation:tw 2.6s infinite}
  @keyframes tw{0%{opacity:0;transform:scale(.6)}40%{opacity:1;transform:scale(1.1)}70%{opacity:.6;transform:scale(.9)}100%{opacity:0;transform:scale(.6)}}

  /* Hero */
  .hero{margin:22px auto;border-radius:14px;overflow:hidden;position:relative}
  .hero .slide{height:420px;background-position:center;background-size:cover;display:flex;align-items:center;justify-content:center}
  .hero .caption{background:linear-gradient(90deg,rgba(0,0,0,0.55),rgba(0,0,0,0.2));padding:20px;border-radius:10px;text-align:center}
  .hero h1{font-family:"Cinzel",serif;color:var(--gold);margin:0;font-size:36px}
  .hero p{margin:8px 0 0 0;color:var(--muted)}

  /* Sections */
  .section{padding:28px 0}
  .section-title{font-family:"Cinzel",serif;color:var(--gold);font-size:22px;text-align:center;margin-bottom:14px}

  /* Categories slider */
  .cats{display:flex;gap:12px;overflow:auto;padding:6px}
  .cat{min-width:170px;background:var(--card-dark);padding:10px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);text-align:center;cursor:pointer}
  .cat img{width:100%;height:120px;object-fit:cover;border-radius:8px}

  /* Product slider */
  .product-slider{display:flex;overflow:auto;gap:12px;padding:10px 0}
  .product{min-width:240px;background:var(--card-dark);border-radius:12px;padding:10px;border:1px solid rgba(255,255,255,0.03)}
  .product img{width:100%;height:200px;object-fit:cover;border-radius:8px}

  /* Grid */
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;margin-top:12px}

  /* Enquiry */
  .enquiry{background:var(--card-dark);padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.04)}
  .enquiry input,.enquiry textarea{width:100%;padding:10px;margin-top:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}

  /* Footer */
  footer{padding:28px 0;text-align:center;border-top:1px solid rgba(255,255,255,0.03);margin-top:20px}

  /* Modal / Product detail */
  .modal{position:fixed;inset:0;background:rgba(0,0,0,0.75);display:none;align-items:center;justify-content:center;z-index:100001;padding:20px}
  .modal.show{display:flex}
  .modal .card{background:var(--card-dark);max-width:1100px;width:100%;display:grid;grid-template-columns:1fr 1fr;gap:18px;padding:18px;border-radius:12px}
  .viewer{background:#000;border-radius:8px;display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}
  .viewer img{max-width:none;user-select:none;cursor:grab;transition:transform .05s}
  .pinfo{color:var(--muted)}
  .variant{display:flex;gap:8px;margin-top:12px;align-items:center;flex-wrap:wrap}
  .size{padding:6px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);cursor:pointer}
  .size.active{background:var(--gold);color:#000}

  /* small screens */
  @media(max-width:900px){
    .modal .card{grid-template-columns:1fr}
    .logo img{height:64px}
    .hero .slide{height:300px}
    #splash img{width:240px}
  }

  /* LIGHT THEME (applied when body has .light) */
  body.light{
    background:var(--bg-light); color:var(--text-light);
  }
  body.light .card, body.light .product, body.light .cat, body.light .enquiry{background:var(--card-light); color:var(--text-light)}
  body.light .muted{color:#666}
  body.light .menu a:hover{color:var(--gold)}
  /* light-mode logo tweak will be applied via JS to add .light-logo on the logo element */
</style>
</head>

<body>

<!-- SPLASH (always shows then hides) -->
<div id="splash" role="dialog" aria-hidden="false">
  <div class="inner" aria-hidden="true">
    <div class="spark" id="spark"></div>
    <img id="splash-logo" alt="Ryaan Jewellers" 
         src="https://raw.githubusercontent.com/ryaanjewellers007/ryaanjewellers007/main/Logo%20new%20ryaan.png">
  </div>
</div>

<!-- HEADER -->
<header>
  <div class="nav wrap" role="banner">
    <div class="logo">
      <img id="siteLogo" alt="Ryaan Jewellers logo" src="https://raw.githubusercontent.com/ryaanjewellers007/ryaanjewellers007/main/Logo%20new%20ryaan.png">
    </div>

    <nav class="menu" role="navigation" aria-label="Main menu">
      <a href="#home" data-i18n="home">Home</a>
      <a href="#categories" data-i18n="categories">Categories</a>
      <a href="#products" data-i18n="products">Products</a>
      <a href="#gold" data-i18n="goldRates">Gold Rates</a>
      <a href="#contact" data-i18n="contact">Contact</a>

      <button id="langBtn" class="btn btn-outline" title="Toggle Arabic / English">AR / EN</button>
      <button id="themeBtn" class="btn btn-outline" title="Toggle theme">‚òÄ / üåô</button>
    </nav>
  </div>
</header>

<!-- HERO -->
<section id="home" class="hero wrap">
  <div class="slide" style="background-image:url('https://raw.githubusercontent.com/ryaanjewellers007/ryaanjewellers007/main/S_1.jpg')">
    <div class="caption">
      <h1 data-i18n="headline">Ryaan Jewellers ‚Äî Gold & Diamonds</h1>
      <p data-i18n="subhead">Crafted with Love & Precious ‚Ä¢ 18K White / Yellow / Rose inspired luxury</p>
    </div>
  </div>
</section>

<!-- MAIN CONTENT -->
<div class="wrap">

  <!-- GOLD RATES -->
  <section id="gold" class="section">
    <div style="display:flex;gap:12px;align-items:center;justify-content:center;flex-wrap:wrap">
      <div style="padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);min-width:260px;text-align:center">
        <div style="font-family:'Cinzel',serif;color:var(--gold);font-size:18px" data-i18n="liveRates">Live UAE Gold Rates</div>
        <div style="margin-top:8px;display:flex;gap:10px;justify-content:center">
          <div><div class="muted">24K</div><div id="g24" style="font-weight:800;color:var(--gold)">--</div></div>
          <div><div class="muted">22K</div><div id="g22" style="font-weight:800;color:var(--gold)">--</div></div>
          <div><div class="muted">18K</div><div id="g18" style="font-weight:800;color:var(--gold)">--</div></div>
        </div>
        <div class="muted" style="margin-top:10px" data-i18n="aedGram">Prices in AED / gram</div>
      </div>

      <div style="max-width:420px;padding:12px;border-radius:12px">
        <canvas id="chart" style="width:100%;height:120px"></canvas>
      </div>
    </div>
  </section>

  <!-- CATEGORIES -->
  <section id="categories" class="section">
    <h3 class="section-title" data-i18n="shopBy">Shop by Category</h3>
    <div class="cats" id="catsRow" aria-label="Categories"></div>
  </section>

  <!-- PRODUCTS -->
  <section id="products" class="section">
    <h3 class="section-title" data-i18n="featured">Featured Collection</h3>
    <div class="product-slider" id="productSlider" aria-live="polite"></div>
  </section>

  <!-- GRID -->
  <section class="section">
    <h3 class="section-title" data-i18n="shopAll">Shop All</h3>
    <div class="grid" id="grid"></div>
  </section>

  <!-- ENQUIRY -->
  <section id="contact" class="section">
    <h3 class="section-title" data-i18n="enquiry">Enquiry / Custom Orders</h3>
    <div class="enquiry">
      <input id="ename" placeholder="Full name">
      <input id="ephone" placeholder="Phone (with country code)">
      <input id="eproduct" placeholder="Product (optional)">
      <textarea id="emessage" rows="4" placeholder="Message / Requirements"></textarea>
      <div style="display:flex;gap:10px;margin-top:10px">
        <button class="btn btn-gold" onclick="sendEnquiry()" data-i18n="whatsapp">Send via WhatsApp</button>
        <button class="btn btn-outline" onclick="triggerCheckout()" data-i18n="checkout">Checkout (Card)</button>
      </div>
    </div>
  </section>

</div> <!-- /wrap -->

<!-- FOOTER -->
<footer>
  <div class="wrap">
    <img id="footLogo" alt="Ryaan logo small" src="https://raw.githubusercontent.com/ryaanjewellers007/ryaanjewellers007/main/Logo%20new%20ryaan.png" style="height:72px;display:block;margin:0 auto 10px">
    <div class="muted">¬© 2025 Ryaan Jewellers ‚Äî Gold & Diamonds ‚Äî Crafted with Love & Precious</div>
    <div class="muted">Email: ryaanjewellers@gmail.com ‚Ä¢ +971543746476 ‚Ä¢ ryaanjewellers.com</div>
  </div>
</footer>

<!-- PRODUCT MODAL / DETAIL -->
<div id="modal" class="modal" role="dialog" aria-hidden="true">
  <div class="card">
    <div class="viewer" id="viewer" tabindex="0" aria-label="Product viewer">
      <img id="viewerImg" src="" alt="product" draggable="false">
    </div>
    <div>
      <h2 id="pTitle"></h2>
      <div class="pinfo" id="pDesc"></div>
      <div style="margin-top:10px">
        <strong data-i18n="price">Price:</strong>
        <span id="pPrice">--</span> AED
      </div>

      <div style="margin-top:12px">
        <div data-i18n="variants">Color</div>
        <div id="variants" class="variant"></div>
      </div>

      <div style="margin-top:12px">
        <div data-i18n="size">Sizes</div>
        <div id="sizes" class="variant"></div>
        <div style="margin-top:8px" class="muted" data-i18n="sizeGuide">Size Guide: XS S M L XL (Specify in enquiry)</div>
      </div>

      <div style="margin-top:16px;display:flex;gap:10px">
        <button class="btn btn-gold" onclick="addCurrentToCart()" data-i18n="addCart">Add to Cart</button>
        <button class="btn btn-outline" onclick="closeModal()" data-i18n="close">Close</button>
      </div>

      <div style="margin-top:12px" class="muted">
        <button onclick="openInstagram()" class="btn btn-outline" style="padding:8px">Instagram</button>
        <button onclick="openWhatsApp()" class="btn btn-outline" style="padding:8px">WhatsApp</button>
      </div>
    </div>
  </div>
</div>

<!-- Chart.js CDN for mini chart -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.min.js"></script>

<script>
/* ============ CONFIG ============ */
const RAW = "https://raw.githubusercontent.com/ryaanjewellers007/ryaanjewellers007/main/";

/* Product files you uploaded (confirmed names) */
const PRODUCTS = [
  { id:'b1', title:'Heart Bangle 18K', images:[RAW+'heart_bangle1.jpg'], purity:18, weight:18, cat:'bangles', priceGram24:500 },
  { id:'r1', title:'Butterfly Ring', images:[RAW+'butterfly_ring.jpg'], purity:18, weight:5, cat:'rings', priceGram24:500 },
  { id:'e1', title:'Chopard Earring', images:[RAW+'chopard_earring.jpg'], purity:18, weight:6, cat:'earrings', priceGram24:500 },
  { id:'s1', title:'Silver Knot Bangle', images:[RAW+'silver_knot_bangle.jpg'], purity:18, weight:15, cat:'bangles', priceGram24:500 },
  { id:'g1', title:'Gold Knot Bangle', images:[RAW+'gold_knot_bangle.jpg'], purity:18, weight:15, cat:'bangles', priceGram24:500 },
  { id:'r2', title:'Rose Knot Bangle', images:[RAW+'rose_knot_bangle.jpg'], purity:18, weight:14, cat:'bangles', priceGram24:500 },
  { id:'c1', title:'Chaumet Bangle', images:[RAW+'chaumet_bangle.jpg'], purity:18, weight:13, cat:'bangles', priceGram24:500 },
  { id:'v1', title:'Van Cleef Multi Color', images:[RAW+'vca_multi_color.jpg'], purity:18, weight:9, cat:'necklaces', priceGram24:500 },
  { id:'h1', title:'Heart Chain Pink', images:[RAW+'heart_chain_pink.jpg'], purity:18, weight:7, cat:'necklaces', priceGram24:500 },
  { id:'ch1',title:'Chopard Heart Chain', images:[RAW+'chopard_heart_chain.jpg'], purity:18, weight:8, cat:'necklaces', priceGram24:500 },
];

/* CATEGORIES */
const CATEGORIES = [
  {id:'necklaces', label:'Necklaces', label_ar:'ŸÇŸÑÿßÿ¶ÿØ'},
  {id:'bangles', label:'Bangles', label_ar:'ÿßÿ≥ÿßŸàÿ±'},
  {id:'rings', label:'Rings', label_ar:'ÿÆŸàÿßÿ™ŸÖ'},
  {id:'earrings', label:'Earrings', label_ar:'ÿ£ŸÇÿ±ÿßÿ∑'},
  {id:'bracelets', label:'Bracelets', label_ar:'ÿ£ÿ≥ÿßŸàÿ± ÿßŸÑÿ≥Ÿàÿßÿ±'}
];

/* ====== State ====== */
let base24 = 500.00; // AED per gram baseline (editable)
let lang = 'EN'; // 'EN' or 'AR'
let theme = 'dark'; // 'dark' or 'light'
let currentProduct = null;
let viewerScale = 1;
let viewerTranslate = {x:0,y:0};
let isPanning = false, panStart = {x:0,y:0}, panOffsetStart = {x:0,y:0};

/* ============ UTILS ============ */
function $id(id){return document.getElementById(id)}
function encode(str){return encodeURIComponent(str||'')}

/* ============ SPLASH (robust) ============ */
(function makeSparkles(){
  const wrap = document.getElementById('spark');
  if(!wrap) return;
  const coords = [{left:'10%',top:'20%',d:0},{left:'70%',top:'22%',d:.4},{left:'38%',top:'72%',d:.9},{left:'82%',top:'64%',d:1.2},{left:'22%',top:'58%',d:1.6}];
  coords.forEach((c,i)=>{
    const s=document.createElement('span'); s.style.left=c.left; s.style.top=c.top; s.style.position='absolute';
    s.style.width=(6+Math.round(Math.random()*9))+'px'; s.style.height=s.style.width; s.style.animationDelay=(c.d + (i*0.1))+'s';
    wrap.appendChild(s);
  });
})();

// Hide splash after load OR timeout even if logo fails
window.addEventListener('load', ()=> setTimeout(hideSplash, 1200));
function hideSplash(){ const s = document.getElementById('splash'); if(s) s.classList.add('hide'); }

/* ============ THEME SWITCH ============ */
const themeBtn = document.getElementById('themeBtn');
themeBtn.addEventListener('click', toggleTheme);
function toggleTheme(){
  if(theme==='dark'){ theme='light'; document.body.classList.add('light'); themeBtn.innerText='‚òÄÔ∏é / ‚òæ'; applyLightLogo(); }
  else{ theme='dark'; document.body.classList.remove('light'); themeBtn.innerText='‚òÄ / üåô'; applyDarkLogo(); }
}
function applyLightLogo(){
  // logo visible in light by applying a small dark stroke via CSS filter (best-effort)
  const logo = document.getElementById('siteLogo');
  const foot = document.getElementById('footLogo');
  logo.style.filter = 'drop-shadow(0 2px 0 rgba(0,0,0,0.6)) saturate(0.9) contrast(0.9)';
  foot.style.filter = logo.style.filter;
}
function applyDarkLogo(){
  const logo = document.getElementById('siteLogo');
  const foot = document.getElementById('footLogo');
  logo.style.filter = 'drop-shadow(0 10px 30px rgba(212,175,55,0.18))';
  foot.style.filter = logo.style.filter;
}

/* ============ LANGUAGE SWITCH ============ */
const i18nMap = {
  EN: {
    home:'Home', categories:'Categories', products:'Products', goldRates:'Gold Rates', contact:'Contact',
    headline:'Ryaan Jewellers ‚Äî Gold & Diamonds', subhead:'Crafted with Love & Precious ‚Ä¢ 18K White / Yellow / Rose inspired',
    liveRates:'Live UAE Gold Rates', aedGram:'Prices in AED / gram', shopBy:'Shop by Category', featured:'Featured Collection', shopAll:'Shop All',
    enquiry:'Enquiry / Custom Orders', whatsapp:'Send via WhatsApp', checkout:'Checkout (Card)', price:'Price:', variants:'Color', size:'Sizes', sizeGuide:'Size Guide: XS S M L XL',
    addCart:'Add to Cart', close:'Close'
  },
  AR: {
    home:'ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©', categories:'ÿßŸÑÿ™ÿµŸÜŸäŸÅÿßÿ™', products:'ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™', goldRates:'ÿ£ÿ≥ÿπÿßÿ± ÿßŸÑÿ∞Ÿáÿ®', contact:'ÿßÿ™ÿµŸÑ',
    headline:'ÿ±ŸäÿßŸÜ ŸÑŸÑŸÖÿ¨ŸàŸáÿ±ÿßÿ™ ‚Äî ÿ∞Ÿáÿ® Ÿà ÿ£ŸÑŸÖÿßÿ≥', subhead:'ŸÖÿµŸÜŸàÿπ ÿ®ÿ≠ÿ® ‚Ä¢ ŸÖÿ¨ŸàŸáÿ±ÿßÿ™ 18 ŸÇŸäÿ±ÿßÿ∑ ‚Ä¢ ÿ•ÿµÿØÿßÿ±ÿßÿ™ ŸÅÿßÿÆÿ±ÿ©',
    liveRates:'ÿ£ÿ≥ÿπÿßÿ± ÿßŸÑÿ∞Ÿáÿ® (ÿßŸÑÿ•ŸÖÿßÿ±ÿßÿ™)', aedGram:'ÿßŸÑÿ£ÿ≥ÿπÿßÿ± ÿ®ÿßŸÑÿØÿ±ŸáŸÖ / ÿ∫ÿ±ÿßŸÖ', shopBy:'ÿ™ÿ≥ŸàŸÇ ÿ≠ÿ≥ÿ® ÿßŸÑŸÅÿ¶ÿ©', featured:'ÿßŸÑŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑŸÖŸÖŸäÿ≤ÿ©', shopAll:'ÿ™ÿ≥ŸàŸÇ ÿßŸÑŸÉŸÑ',
    enquiry:'ÿßŸÑÿßÿ≥ÿ™ŸÅÿ≥ÿßÿ±ÿßÿ™ / ÿßŸÑÿ∑ŸÑÿ®ÿßÿ™ ÿßŸÑŸÖÿÆÿµÿµÿ©', whatsapp:'ÿ•ÿ±ÿ≥ÿßŸÑ ÿπÿ®ÿ± Ÿàÿßÿ™ÿ≥ÿßÿ®', checkout:'ÿßŸÑÿØŸÅÿπ (ÿ®ÿ∑ÿßŸÇÿ©)', price:'ÿßŸÑÿ≥ÿπÿ±:', variants:'ÿßŸÑÿ£ŸÑŸàÿßŸÜ', size:'ÿßŸÑŸÖŸÇÿßÿ≥ÿßÿ™', sizeGuide:'ÿØŸÑŸäŸÑ ÿßŸÑŸÖŸÇÿßÿ≥ÿßÿ™: XS S M L XL',
    addCart:'ÿ£ÿ∂ŸÅ ÿ•ŸÑŸâ ÿßŸÑÿ≥ŸÑÿ©', close:'ÿ•ÿ∫ŸÑÿßŸÇ'
  }
};
const langBtn = document.getElementById('langBtn');
langBtn.addEventListener('click', toggleLang);
function toggleLang(){
  lang = (lang==='EN'?'AR':'EN');
  document.documentElement.dir = (lang==='AR'?'rtl':'ltr');
  applyTranslations();
}
function applyTranslations(){
  document.querySelectorAll('[data-i18n]').forEach(el=>{
    const key = el.getAttribute('data-i18n');
    if(i18nMap[lang] && i18nMap[lang][key]) el.innerText = i18nMap[lang][key];
  });
  // Also switch header menu order for RTL if needed
  // (keep layout simple ‚Äî we just change dir)
}

/* ============ GOLD PRICE CHART ============ */
let chart; const chartData={labels:[],datasets:[{label:'24K AED/g',data:[],borderColor:'#D4AF37',backgroundColor:'rgba(212,175,55,0.08)',tension:0.3}]};
function createChart(){
  const ctx = document.getElementById('chart').getContext('2d');
  chart = new Chart(ctx,{type:'line',data:chartData,options:{responsive:true,plugins:{legend:{display:false}},scales:{x:{display:false},y:{display:true}}}});
}
function pushChartPoint(v){
  const now = new Date(); const t = now.getHours()+':'+String(now.getMinutes()).padStart(2,'0');
  chartData.labels.push(t); chartData.datasets[0].data.push(Number(v.toFixed(2)));
  if(chartData.labels.length>30){chartData.labels.shift(); chartData.datasets[0].data.shift();}
  if(chart) chart.update();
}
function updateGoldDisplay(){
  const p24 = base24; const p22 = p24*(22/24); const p18 = p24*(18/24);
  document.getElementById('g24').innerText = p24.toFixed(2); document.getElementById('g22').innerText = p22.toFixed(2); document.getElementById('g18').innerText = p18.toFixed(2);
  pushChartPoint(p24);
}
setInterval(()=>{ base24 = base24 * (1 + (Math.random()-0.5)*0.0015); updateGoldDisplay(); }, 30000);

/* ============ RENDER UI ============ */
function renderCategories(){
  const row = document.getElementById('catsRow'); row.innerHTML='';
  CATEGORIES.forEach(c=>{
    const el = document.createElement('div'); el.className='cat'; el.tabIndex=0;
    el.innerHTML = `<img src="${RAW}S_2.jpg" alt="${c.label}"><div style="margin-top:8px;font-weight:700;color:var(--gold)">${lang==='AR'?c.label_ar:c.label}</div>`;
    el.onclick = ()=>{ filterCategory(c.id) };
    row.appendChild(el);
  });
}

function renderSlider(){
  const out = document.getElementById('productSlider'); out.innerHTML='';
  PRODUCTS.forEach(p=>{
    const d = document.createElement('div'); d.className='product';
    d.innerHTML = `<img src="${p.images[0]}" alt="${p.title}" loading="lazy"><div style="margin-top:8px;font-weight:700;color:var(--gold)">${p.title}</div><div class="muted">${p.purity}K ‚Ä¢ ${p.weight}g</div><div style="margin-top:8px"><button class="btn btn-gold" onclick="openProduct('${p.id}')">${lang==='AR'?'ÿ™ŸÅÿßÿµŸäŸÑ':'View'}</button></div>`;
    out.appendChild(d);
  });
}

function renderGrid(list){
  const grid = document.getElementById('grid'); grid.innerHTML='';
  (list||PRODUCTS).forEach(p=>{
    const el = document.createElement('div'); el.className='product';
    el.innerHTML = `<img src="${p.images[0]}" alt="${p.title}" loading="lazy" style="width:100%;height:160px;object-fit:cover;border-radius:8px"><div style="margin-top:8px;font-weight:700;color:var(--gold)">${p.title}</div><div class="muted">${p.purity}K ‚Ä¢ ${p.weight}g</div><div style="margin-top:8px;display:flex;gap:8px"><button class="btn btn-gold" style="flex:1" onclick="openProduct('${p.id}')">${lang==='AR'?'ÿπÿ±ÿ∂':'View'}</button><button class="btn btn-outline" style="flex:1" onclick="addToCart('${p.id}')">${lang==='AR'?'ÿ£ÿ∂ŸÅ':'Add'}</button></div>`;
    grid.appendChild(el);
  });
}

/* ============ FILTER ============ */
function filterCategory(cat){
  const f = PRODUCTS.filter(p=>p.cat===cat);
  renderGrid(f);
  // scroll to grid
  document.querySelector('html,body').scrollTop = 0;
}

/* ============ PRODUCT VIEWER / MODAL ============ */
const modal = $id('modal');
const viewerImg = $id('viewerImg');
function openProduct(pid){
  const p = PRODUCTS.find(x=>x.id===pid);
  if(!p) return alert('Product not found');
  currentProduct = p;
  $id('pTitle').innerText = p.title;
  $id('pDesc').innerText = `Purity ${p.purity}K ‚Ä¢ ${p.weight}g ‚Ä¢ Inspired luxury`;
  // price calculation approximate: price = base24 * weight * (purity/24)
  const price = base24 * (p.purity/24) * p.weight;
  $id('pPrice').innerText = Number(price).toFixed(2);
  // variants (colors)
  const varNode = $id('variants'); varNode.innerHTML = '';
  ['Yellow','White','Rose'].forEach(clr=>{
    const b = document.createElement('button'); b.className='size'; b.innerText = clr; b.onclick=()=>{ /* color change if images available */ };
    varNode.appendChild(b);
  });
  // sizes
  const sizes = ['XS','S','M','L','XL'];
  const sizesNode = $id('sizes'); sizesNode.innerHTML='';
  sizes.forEach(s=>{
    const el = document.createElement('div'); el.className='size'; el.innerText = s;
    el.onclick = ()=>{ document.querySelectorAll('#sizes .size').forEach(x=>x.classList.remove('active')); el.classList.add('active'); };
    sizesNode.appendChild(el);
  });

  // viewer image
  viewerImg.src = p.images[0];
  viewerScale = 1; viewerTranslate={x:0,y:0}; viewerImg.style.transform = 'translate(0px,0px) scale(1)';
  modal.classList.add('show'); modal.setAttribute('aria-hidden','false');
  // reset pan
  setTimeout(()=>{$id('viewer').focus()},220);
}

/* close modal */
function closeModal(){ modal.classList.remove('show'); modal.setAttribute('aria-hidden','true'); }

/* add current product to cart */
function addCurrentToCart(){ if(!currentProduct) return; addToCart(currentProduct.id); closeModal(); }

/* open social */
function openInstagram(){ window.open('https://instagram.com/ryaanjewellers007','_blank'); }
function openWhatsApp(){ window.open('https://wa.me/971543746476','_blank'); }

/* Modal drag/zoom */
const vwr = $id('viewer');
vwr.addEventListener('wheel', (e)=> {
  e.preventDefault();
  const delta = -e.deltaY * 0.0015; viewerScale = Math.min(4, Math.max(1, viewerScale + delta));
  viewerImg.style.transform = `translate(${viewerTranslate.x}px,${viewerTranslate.y}px) scale(${viewerScale})`;
});
vwr.addEventListener('pointerdown', (e)=> {
  isPanning=true; panStart={x:e.clientX,y:e.clientY}; panOffsetStart={...viewerTranslate}; vwr.style.cursor='grabbing';
});
window.addEventListener('pointermove', (e)=> {
  if(!isPanning) return;
  const dx = e.clientX - panStart.x; const dy = e.clientY - panStart.y;
  viewerTranslate.x = panOffsetStart.x + dx; viewerTranslate.y = panOffsetStart.y + dy;
  viewerImg.style.transform = `translate(${viewerTranslate.x}px,${viewerTranslate.y}px) scale(${viewerScale})`;
});
window.addEventListener('pointerup', ()=> { isPanning=false; vwr.style.cursor='grab'; });

/* keyboard close */
window.addEventListener('keydown',(e)=>{ if(e.key==='Escape') closeModal(); });

/* ============ CART (localStorage) ============ */
function getCart(){ return JSON.parse(localStorage.getItem('ry_cart')||'[]'); }
function saveCart(c){ localStorage.setItem('ry_cart',JSON.stringify(c)); }
function addToCart(pid){ const cart = getCart(); const item = cart.find(x=>x.id===pid); if(item) item.qty++; else cart.push({id:pid,qty:1}); saveCart(cart); alert((lang==='AR'?'ÿ™ŸÖÿ™ ÿßŸÑÿ•ÿ∂ÿßŸÅÿ© ÿ•ŸÑŸâ ÿßŸÑÿ≥ŸÑÿ©':'Added to cart')); }

/* ============ ENQUIRY / WHATSAPP ============ */
function sendEnquiry(){
  const name = encode($id('ename').value); const phone = encode($id('ephone').value);
  const product = encode($id('eproduct').value); const msg = encode($id('emessage').value);
  const body = `Name: ${name}%0aPhone: ${phone}%0aProduct: ${product}%0aMessage: ${msg}`;
  // open whatsapp
  window.open('https://wa.me/971543746476?text=' + body, '_blank');
}

/* placeholder checkout */
function triggerCheckout(){ alert('To accept card payments you must integrate Stripe/PayPal. I can provide serverless code and deploy.'); }

/* ============ BOOTSTRAP UI ============ */
function boot(){
  createChart(); updateGoldDisplay();
  renderCategories(); renderSlider(); renderGrid();
  applyTranslations(); applyDarkLogo();
  // ensure splash hides after max 3s
  setTimeout(hideSplash, 3000);
}
document.addEventListener('DOMContentLoaded', boot);

/* ============ Accessibility smooth scroll for anchor links ============ */
document.querySelectorAll('a[href^="#"]').forEach(a=>a.addEventListener('click',function(e){ e.preventDefault(); const t=document.querySelector(this.getAttribute('href')); if(t) t.scrollIntoView({behavior:'smooth'}); }));

</script>
</body>
</html>
